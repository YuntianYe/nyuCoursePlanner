!function(t){function e(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";var r,a={"2018 Spring":{"NYU Shanghai":"albert/nyushanghai-2018s.json"},"2017 Fall":{"NYU Shanghai":"albert/nyushanghai-2017f.json"}},o=function(){var t={},e="",n="";for(var r in a){for(var o in a[r])!function(){var e=r,i=o;$.get(a[e][i]).done(function(t){a[e][i]=t}),o in t||(t[o]=!0,n+='<li><a dataplace="dataswitcher" href="javascript:" data1="location" data2="'+o+'">'+o+"</a></li>")}();r in t||(t[r]=!0,e+='<li><a dataplace="dataswitcher" href="javascript:" data1="semester" data2="'+r+'">'+r+"</a></li>")}$("#toAddSemester").html(e),$("#toAddLocation").html(n),i()},i=function(){$('a[dataplace="dataswitcher"]').on("click",function(t){var e=$(t.target);w(e.attr("data1"),e.attr("data2"))})},s=function(t){var e=t;if(""==t.data)U([]);else if(a.hasOwnProperty(t.semester))if(a[t.semester].hasOwnProperty(t.location)){for(var n=a[t.semester][t.location],r=[],o={},i=0;i<n.Count;i++)-1==u(n.Content[i].topic,e.data)&&-1==u(n.Content[i].instructor,e.data)&&-1==u(n.Content[i].id,e.data)&&-1==u("num["+n.Content[i].classNum+"]","num["+e.data)||o.hasOwnProperty(n.Content[i].id)||(r.push({id:n.Content[i].id,title:n.Content[i].topic}),o[n.Content[i].id]=!0);U(r)}else J("Please Select the Location First!",5e3),U([]);else J("Please Select the Semester First!",5e3),U([])},c=function(t){if(a.hasOwnProperty(t.semester))if(a[t.semester].hasOwnProperty(t.location))try{var e=a[t.semester][t.location],n=t.cart,r=0,o={},i=[];for(var s in n)if(!o.hasOwnProperty(n[s].id)){o[n[s].id]=[],o[n[s].id+"-rec"]=[],o[n[s].id+"-lab"]=[];for(var c in e.Content)e.Content[c].id==n[s].id&&("Recitation"==e.Content[c].component?""!=e.Content[c].schedule&&o[n[s].id+"-rec"].push(e.Content[c]):"Laboratory"==e.Content[c].component?""!=e.Content[c].schedule&&o[n[s].id+"-lab"].push(e.Content[c]):""!=e.Content[c].schedule&&o[n[s].id].push(e.Content[c]));var l="";if(o[n[s].id].length>0?(r++,l=o[n[s].id][0].session,i.push(n[s].id)):delete o[n[s].id],o[n[s].id+"-rec"].length>0){r++;for(var u in o[n[s].id+"-rec"])o[n[s].id+"-rec"][u].session=l;i.push(n[s].id+"-rec")}else delete o[n[s].id+"-rec"];if(o[n[s].id+"-lab"].length>0){r++;for(var u in o[n[s].id+"-lab"])o[n[s].id+"-lab"][u].session=l;i.push(n[s].id+"-lab")}else delete o[n[s].id+"-lab"]}r>10&&H([]);var d=[];h(d,o,i,0,r,[]);var s=0;H(d)}catch(t){H([])}else J("Please Select the Location First!",5e3),H([]);else J("Please Select the Semester First!",5e3),H([])},l=function(t,e){var n=24*t*60;return-1!=e.indexOf("PM")&&-1==e.indexOf("12")&&(n+=720),e=e.replace("PM",""),e=e.replace("AM",""),e=e.replace(/ /g,""),n+=60*parseInt(e.split(".")[0]),n+=parseInt(e.split(".")[1])},u=function(t,e){return t.toLowerCase().replace(/[^0-9a-z]/g,"").indexOf(e.toLowerCase().replace(/[^0-9a-z]/g,""))},d=function(t,e){return t.start-e.start},f=function(t){var e=[];for(var n in t)for(var r in t[n].days){var a={};a.start=l(v[t[n].days[r]],t[n].schedule.split("-")[0]),a.end=l(v[t[n].days[r]],t[n].schedule.split("-")[1]),e.push(a)}for(e.sort(d),n=1;n<e.length;n++)if(e[n].start<e[n-1].end)return!1;return!0},h=function t(e,n,r,a,o,i){if(a<o)for(var s in n[r[a]])i.push(n[r[a]][s]),t(e,n,r,a+1,o,i),i.pop();else f(i)&&e.push(JSON.parse(JSON.stringify(i)))},p=["#1ABC9C","#16A085","#2ECC71","#27AE60","#3498DB","#2980B9","#9B59B6","#8E44AD","#F1C40F","#F39C12","#E67E22","#D35400","#E74C3C","#C0392B","#ECF0F1","#BDC3C7","#95A5A6","#7F8C8D"],v={Mon:0,Tue:1,Wed:2,Thu:3,Fri:4},g={semester:"",location:"",data:""},m=1,y=[],b=[],C={},N=[],S=null,w=function(t,e){return g.hasOwnProperty(t)?(g[t]=e,g.data="",localStorage.setItem("NCPData",JSON.stringify(g)),$("tx#"+t).html(e),1):0},O=function(){for(var t in g)"data"!=t&&""!=g[t]&&$("tx#"+t).html(g[t])},E=function(t){if(g!=$("#navinp").val()){g.data=$("#navinp").val();for(var e in g)if(""==g[e]&&"data"!=e)return $("#navinp").val(""),g.data="",$("#navinp").css("background-color","indianred"),J("Please Select Semester and Location.",5e3),void t.preventDefault();$("#navinp").css("background-color",""),G(),s(g)}},T=function(t){return t>9?""+t:"0"+t},D=function(){var t="";t+="<tr><td>Weekly</td><td>Monday</td><td>Tuesday</td><td>Wednesday</td><td>Thursday</td><td>Friday</td></tr>";for(var e=7;e<21;e++){t+="<tr><td>&nbsp;<br />"+T(e)+":00 - "+T(e+1)+":00<br />&nbsp;</td>";for(var n=1;n<6;n++)t+='<td id="cr_'+n+"_"+e+'"></td>';t+="</tr>"}$("#cal").html(t)},P=function(t,e,n,r,a,o,i,s,c){var l=$("#"+t).html(),u="";return!i&&n-e>50&&(u="<b>"+r+"</b><br /><small>"+a+"</small>"),l+='<div class="course '+c+'" style="top:'+e+"%;height:"+(n-e)+"%;background-color:"+p[o]+'" course="'+s+'" addonData="'+a+'">'+u+"</div>",$("#"+t).html(l),""!=u},k=function(t,e,n,r){var a=e.split("-"),o=[];for(var i in a){var s=0;-1!=a[i].indexOf("PM")&&-1==a[i].indexOf("12")&&(s=12),o.push({hour:parseInt(a[i].split(".")[0])+s,minute:parseInt(a[i].split(".")[1].replace("PM","").replace("AM",""))})}var c=!1;-1!=N.indexOf(n.classNum)&&(c=!0);var l=n.topic+"<br /><b>"+n.instructor+"</b><br />"+n.classNum,u=!1;u=P("cr_"+t+"_"+o[0].hour,o[0].minute/60*100,100,n.id,l,r,u,n.classNum,c?"highlight-top highlight-side":"");for(var i=o[0].hour+1;i<o[1].hour;i++){var d="highlight-side";i==o[1].hour-1&&0==o[1].minute&&(d+=" highlight-bottom"),u=P("cr_"+t+"_"+i,0,100,n.id,l,r,u,n.classNum,c?d:"")}0!=o[1].minute&&(u=P("cr_"+t+"_"+o[1].hour,0,o[1].minute/60*100,n.id,l,r,u,n.classNum,c?"highlight-bottom highlight-side":""))},I=function(){$("div.course").on("click",function(t){t.preventDefault();for(var e=$(t.target);!e.attr("course");)e=e.parent();var n=e.attr("course");-1==N.indexOf(n)?N.push(n):N.splice(N.indexOf(n),1),_(m-1)})},M=function(t){$("#courselist").html("");var e="";for(var n in t)e+='<li><a href="javascript:" listcoursedata="'+t[n].id+'"><b listcoursedata="'+t[n].id+'">'+t[n].title+'</b><br /><small listcoursedata="'+t[n].id+'">'+t[n].id+'</small></a></li><li class="divider"></li>';e+='<li><a id="closecart" href="javascript:"><b>Close</b></a></li>',$("#courselist").html(e),A()},A=function(){$("a[listcoursedata]").on("click",function(t){var e=$(t.target);L(e.attr("listcoursedata"))}),$("#closecart").on("click",function(){$("#courselist").css("display","none")})},x=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]||localStorage.setItem("NCPCart",JSON.stringify(y)),$("#cart").html("");var t="";for(var e in y)t+='<dl removecartdata="'+e+'" class="palette cartitem" style="background-color: '+p[e]+'"><dt removecartdata="'+e+'">'+y[e].id+'</dt><dd removecartdata="'+e+'">'+y[e].title+"</dd></dl>";$("#cart").html(t),R()},R=function(){$("dl[removecartdata]").on("click",function(t){var e=$(t.target);F(e.attr("removecartdata"))})},F=function(t){y.splice(t,1),x()},L=function(t){C.hasOwnProperty(t)&&(y.push(C[t]),x(),$("#courselist").css("display","none"))},U=function(t){for(var e in t)C.hasOwnProperty(t[e].id)||(C[t[e].id]=t[e]);M(t)},B=function(){c({semester:g.semester,location:g.location,cart:y})},_=function(t){if(!(b.length<=t)){localStorage.setItem("NCPCurPage",t+1),$("#pagenum").html(t+1+"/"+b.length);for(var e in b[t])for(var n in b[t][e].days)k(v[b[t][e].days[n]]+1,b[t][e].schedule,b[t][e],e);I()}},H=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];b=t,n||(localStorage.setItem("NCPStorage",JSON.stringify(b)),localStorage.setItem("NCPCurPage",1)),t.length>0&&(m=e,D(),_(m-1))},j=function(){if(m>1){for(var t=m-1;t>=1;){var e=!0;for(var n in N){var r=!1;for(var a in b[t-1])b[t-1][a].classNum==N[n]&&(r=!0);if(!r){e=!1;break}}if(e)break;if(--t<1)return}m=t,D(),_(m-1)}},Y=function(){if(m<b.length){for(var t=m+1;t<=b.length;){var e=!0;for(var n in N){var r=!1;for(var a in b[t-1])b[t-1][a].classNum==N[n]&&(r=!0);if(!r){e=!1;break}}if(e)break;if(++t>b.length)return}m=t,D(),_(m-1)}},V=function(){m<=0||b.length<=0||et(b[m-1])},Z=function(){var t=!1;try{var e=JSON.parse(localStorage.getItem("NCPData"));null!=e&&"semester"in e&&"location"in e&&(t=!0,g=e,O());var n=JSON.parse(localStorage.getItem("NCPCart"));null!=n&&(t=!0,y=n,x(!0));var r=JSON.parse(localStorage.getItem("NCPStorage")),a=localStorage.getItem("NCPCurPage");return null!=r&&null!=a&&(t=!0,H(r,a,!0)),t}catch(e){return t}},J=function(t,e){$("#snackbar>p").text(t),$("#snackbar").removeClass("snackbar-hide"),$("#snackbar").addClass("snackbar-show"),e&&!isNaN(e)&&(S&&clearTimeout(S),S=setTimeout(function(){G()},e))},G=function(){S=null,$("#snackbar>p").text(""),$("#snackbar").removeClass("snackbar-show"),$("#snackbar").addClass("snackbar-hide")};$(window).on("load",function(){D(),o(),Z()?J("History Loaded - NHibiki",5e3):J("NYUCourse by YuunoHibiki.",5e3),$("#startplan").on("click",function(){B()}),$("#icsdown").on("click",function(){V()}),$("#preva").on("click",function(){j()}),$("#nexta").on("click",function(){Y()}),$("#navinp").on("keyup",function(t){E(t)}),$("#navinp").on("focusin",function(t){$("#courselist").css("display","")}),$("#courselist").on("focusout",function(t){$("#courselist").css("display","none")}),$("#snackbar").on("click",function(t){G()})});var W=W||function(t){if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=t.document,n=function(){return t.URL||t.webkitURL||t},r=e.createElementNS("http://www.w3.org/1999/xhtml","a"),a="download"in r,o=function(t){var e=new MouseEvent("click");t.dispatchEvent(e)},i=/constructor/i.test(t.HTMLElement)||t.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent),c=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},l=function(t){var e=function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()};setTimeout(e,4e4)},u=function(t,e,n){e=[].concat(e);for(var r=e.length;r--;){var a=t["on"+e[r]];if("function"==typeof a)try{a.call(t,n||t)}catch(t){c(t)}}},d=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},f=function(e,c,f){f||(e=d(e));var h,p=this,v=e.type,g="application/octet-stream"===v,m=function(){u(p,"writestart progress write writeend".split(" "))};if(p.readyState=p.INIT,a)return h=n().createObjectURL(e),void setTimeout(function(){r.href=h,r.download=c,o(r),m(),l(h),p.readyState=p.DONE});!function(){if((s||g&&i)&&t.FileReader){var r=new FileReader;return r.onloadend=function(){var e=s?r.result:r.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),p.readyState=p.DONE,m()},r.readAsDataURL(e),void(p.readyState=p.INIT)}if(h||(h=n().createObjectURL(e)),g)t.location.href=h;else{t.open(h,"_blank")||(t.location.href=h)}p.readyState=p.DONE,m(),l(h)}()},h=f.prototype,p=function(t,e,n){return new f(t,e||t.name||"download",n)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,n){return e=e||t.name||"download",n||(t=d(t)),navigator.msSaveOrOpenBlob(t,e)}:(h.abort=function(){},h.readyState=h.INIT=0,h.WRITING=1,h.DONE=2,h.error=h.onwritestart=h.onprogress=h.onwrite=h.onabort=h.onerror=h.onwriteend=null,p)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||(void 0).content);void 0!==t&&t.exports?t.exports.saveAs=W:null!==n(1)&&null!==n(2)&&void 0!==(r=function(){return W}.call(e,n,e,t))&&(t.exports=r);var K=["SU","MO","TU","WE","TH","FR","SA"];Date.prototype.Format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in e)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[n]:("00"+e[n]).substr((""+e[n]).length)));return t};var z=function(t){return new Date(t.getTime()+864e5)},q=function(t){return new Date(t.getTime()-864e5)},Q=function(t,e,n,r,a,o){for(var i=new Date(t+" "+n),s=new Date(t+" "+r),c=new Date(e+" "+r),l=0;-1==a.indexOf(K[new Date(i).getDay()])&&(l++,i=z(i),s=z(s),!(l>=7)););for(l=0;-1==a.indexOf(K[new Date(c).getDay()])&&(l++,c=q(c),!(l>=7)););var u="";return u+="BEGIN:VEVENT\nUID:nyuCoursePlanner"+(""+Math.random()).slice(3,8)+"\nDTSTAMP:"+(new Date).Format("yyyyMMddThhmmss")+"Z\nCREATED:"+(new Date).Format("yyyyMMddThhmmss")+"Z\nDTSTART:"+i.Format("yyyyMMddThhmmss")+"\nDTEND:"+s.Format("yyyyMMddThhmmss")+"\nRRULE:FREQ=WEEKLY;UNTIL="+c.Format("yyyyMMddThhmmss")+"Z;BYDAY="+a+"\nSUMMARY:"+o+"\nEND:VEVENT\n"},X=function(t){try{if(!t.hasOwnProperty("session")||""==t.session)return"";if(!t.hasOwnProperty("schedule")||""==t.schedule)return"";if(!t.hasOwnProperty("days")||t.days.length<1)return"";var e=t.session.toLowerCase().replace(/[a-z]/g,"").split("-"),n=t.schedule.replace(/\./g,":").split("-"),r="";for(var a in t.days)r+=t.days[a].slice(0,2).toUpperCase()+",";r=r.slice(0,r.length-1);var o="STAFF";return""!=t.instructor.replace(/ /g,"")&&(o=t.instructor),Q(e[0],e[1],n[0],n[1],r,t.topic+" - "+o)}catch(t){return""}},tt=function(t){var e="";for(var n in t)e+=X(t[n]);return"BEGIN:VCALENDAR\nPRODID:-//Yuuno Hibiki//NYU Course Planner//EN\nVERSION:2.0\nCALSCALE:GREGORIAN\nMETHOD:PUBLISH\nBEGIN:VTIMEZONE\nTZID:Asia/Hong_Kong\nX-LIC-LOCATION:Asia/Hong_Kong\nBEGIN:STANDARD\nTZOFFSETFROM:+0800\nTZOFFSETTO:+0800\nTZNAME:HKT\nDTSTART:19700101T000000\nEND:STANDARD\nEND:VTIMEZONE\n"+e+"END:VCALENDAR"},et=function(t){var e=tt(t),n=new Blob([e],{type:"text/calendar;charset=utf-8"});W(n,"nyuCoursePlanner.ics")}},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e){(function(e){t.exports=e}).call(e,{})}]);